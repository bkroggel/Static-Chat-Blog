<section class="list" >
  {% for post in site.posts %}
  {% assign contact = site.data.contacts[post.contact] %}
    <div class="chat" id="{{contact.short}}">
      <div class="chat-icon">
        {% if contact.profil_pic %}
        <img src="../assets/img/face/{{contact.profil_pic}}" alt="{{contact.profil_pic}}">
        {% endif %}
      </div>
      <div class="content">
        <div class="first-line">
          <h1>{{contact.name}}</h1>
          <h2>
            <span class="date-{{contact.short}}" id="date-{{contact.short}}">{%if post.historys %}{% assign historys = post.historys | sort: 'some_field' | reverse %}{% for history in historys %}{% if break_sure == true %}{% assign break_sure = false %}{% break %}{% else %}{% assign messages = history.messages | sort: 'some_field' | reverse %}{% for message in history.messages %}{% if {{message.name}} contains {{contact.short}} %}{{history.date}}{% assign break_sure = true %}{% break %}{% endif %}{% endfor %}{% endif %}{% endfor %}{% endif %}
            </span>
            <span style="display: none" class="list-today-{{contact.short}}">
              {% if post.historys %}
              {% assign historys = post.historys | sort: 'some_field' | reverse %}
              {% for history in historys %}
              {% if break_sure == true %}
              {% assign break_sure = false %}
                {% break %}
              {% else %}
                {% assign messages = history.messages | sort: 'some_field' | reverse %}
                {% for message in messages %}
                  {% if {{message.name}} contains {{contact.short}} %}
                    {% assign break_sure = true %}
                    {% assign contents = message.contents | sort: 'some_field' | reverse %}
                    {% for content in contents limit:1%}
                      {{content.time}}
                    {% endfor %}
                  {% endif %}
                {% endfor %}
              {% endif %}
              {% endfor %}
              {% endif %}
            </span>
          </h2>
        </div>
        <p>
          {% if post.historys %}
          {% assign historys = post.historys | sort: 'some_field' | reverse %}
          {% for history in historys limit:1 %}
              {% assign messages = history.messages | sort: 'some_field' | reverse %}
              {% for message in messages limit:1%}
                {% assign contents = message.contents | sort: 'some_field' | reverse %}
                {% for content in contents limit:1%}
                  {{content.text}}
                {% endfor %}
              {% endfor %}
          {% endfor %}
          {% endif %}
        </p>
      </div>
    </div>
  {% endfor %}
</section>